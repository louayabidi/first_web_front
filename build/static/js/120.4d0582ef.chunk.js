"use strict";(self.webpackChunkgypsum_app=self.webpackChunkgypsum_app||[]).push([[120],{2120:(e,i,t)=>{t.r(i),t.d(i,{default:()=>o});var s=t(5043),a=t(6213),n=t(8729),l=t(8268),c=t(1283),r=t(579);const o=function(){const{user:e,logout:i}=(0,s.useContext)(n.c),{triggerRefresh:t}=(0,s.useContext)(l.h),o=(0,c.Zp)(),[d,p]=(0,s.useState)([]),[u,h]=(0,s.useState)({title:"",description:"",link:"",image:null,isActive:!0}),[m,v]=(0,s.useState)(null),[g,x]=(0,s.useState)(""),[j,k]=(0,s.useState)(""),A=(void 0).VITE_API_URL||"http://localhost:5000",y=(0,s.useCallback)(async()=>{try{const e=await a.A.get(`${A}/api/services`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});p(e.data.services)}catch(e){x("Failed to fetch services"),console.error(e)}},[A]);(0,s.useEffect)(()=>{e&&"admin"===e.role?y():o("/login")},[e,o,y]);const f=e=>{const{name:i,type:t,value:s,files:a,checked:n}=e.target;h("file"===t?{...u,image:a[0]}:"checkbox"===t?{...u,isActive:n}:{...u,[i]:s})};return(0,r.jsxs)("section",{className:"admin-dashboard",children:[(0,r.jsxs)("div",{className:"admin-header",children:[(0,r.jsx)("h1",{children:"Admin Dashboard"}),(0,r.jsx)("button",{onClick:i,children:"Logout"})]}),(0,r.jsx)("h2",{children:m?"Edit Service":"Add Service"}),g&&(0,r.jsx)("p",{className:"error",children:g}),j&&(0,r.jsx)("p",{className:"success",children:j}),(0,r.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),x(""),k("");const i=new FormData;i.append("title",u.title),i.append("description",u.description),u.link&&i.append("link",u.link),i.append("isActive",u.isActive),u.image&&i.append("image",u.image);try{m?(await a.A.put(`${A}/api/services/${m}`,i,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}}),k("\u2705 Service updated successfully!")):(await a.A.post(`${A}/api/services`,i,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}}),k("\u2705 Service added successfully!")),h({title:"",description:"",link:"",image:null,isActive:!0}),v(null),document.getElementById("image-input").value="",y(),t()}catch(l){var s,n;x((null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.error)||"Failed to save service"),console.error(l)}},encType:"multipart/form-data",children:[(0,r.jsxs)("label",{children:["Title",(0,r.jsx)("input",{type:"text",name:"title",value:u.title,onChange:f,required:!0})]}),(0,r.jsxs)("label",{children:["Description",(0,r.jsx)("textarea",{name:"description",value:u.description,onChange:f,required:!0})]}),(0,r.jsxs)("label",{children:["Link",(0,r.jsx)("input",{type:"text",name:"link",value:u.link,onChange:f,placeholder:"Optional"})]}),(0,r.jsxs)("label",{children:["Image",(0,r.jsx)("input",{id:"image-input",type:"file",name:"image",accept:"image/*",onChange:f,required:!m})]}),(0,r.jsxs)("label",{children:["Active",(0,r.jsx)("input",{type:"checkbox",name:"isActive",checked:u.isActive,onChange:f})]}),(0,r.jsxs)("button",{type:"submit",children:[m?"Update":"Add"," Service"]})]}),(0,r.jsx)("h2",{children:"Services List"}),(0,r.jsx)("div",{className:"services-list",children:d.map(e=>(0,r.jsxs)("div",{className:"service-item",children:[e.image&&(0,r.jsx)("img",{src:`${A}${e.image}`,alt:e.title}),(0,r.jsx)("h3",{children:e.title}),(0,r.jsx)("p",{children:e.description}),e.link&&(0,r.jsxs)("p",{children:["Link: ",e.link]}),(0,r.jsxs)("p",{children:["Status: ",e.isActive?"Active":"Inactive"]}),(0,r.jsx)("button",{onClick:()=>(e=>{h({title:e.title,description:e.description,link:e.link||"",image:null,isActive:e.isActive}),v(e._id)})(e),children:"Edit"}),(0,r.jsx)("button",{onClick:()=>(async e=>{try{await a.A.delete(`${A}/api/services/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),k("\u2705 Service deleted successfully!"),y(),t()}catch(i){x("Failed to delete service"),console.error(i)}})(e._id),children:"Delete"})]},e._id))})]})}}}]);
//# sourceMappingURL=120.4d0582ef.chunk.js.map