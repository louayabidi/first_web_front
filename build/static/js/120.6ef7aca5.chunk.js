"use strict";(self.webpackChunkgypsum_app=self.webpackChunkgypsum_app||[]).push([[120],{2120:(e,i,t)=>{t.r(i),t.d(i,{default:()=>o});var s=t(5043),a=t(6213),n=t(8729),l=t(8268),c=t(1283),r=t(4505),d=t(579);const o=function(){const{user:e,logout:i}=(0,s.useContext)(n.c),{triggerRefresh:t}=(0,s.useContext)(l.h),o=(0,c.Zp)(),[u,p]=(0,s.useState)([]),[h,m]=(0,s.useState)({title:"",description:"",link:"",image:null,isActive:!0}),[v,g]=(0,s.useState)(null),[x,j]=(0,s.useState)(""),[k,A]=(0,s.useState)(""),y=(0,s.useCallback)(async()=>{try{const e=await a.A.get(`${r.A}/api/services`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});p(e.data.services)}catch(e){j("Failed to fetch services"),console.error(e)}},[]);(0,s.useEffect)(()=>{e&&"admin"===e.role?y():o("/login")},[e,o,y]);const f=e=>{const{name:i,type:t,value:s,files:a,checked:n}=e.target;m("file"===t?{...h,image:a[0]}:"checkbox"===t?{...h,isActive:n}:{...h,[i]:s})};return(0,d.jsxs)("section",{className:"admin-dashboard",children:[(0,d.jsxs)("div",{className:"admin-header",children:[(0,d.jsx)("h1",{children:"Admin Dashboard"}),(0,d.jsx)("button",{onClick:i,children:"Logout"})]}),(0,d.jsx)("h2",{children:v?"Edit Service":"Add Service"}),x&&(0,d.jsx)("p",{className:"error",children:x}),k&&(0,d.jsx)("p",{className:"success",children:k}),(0,d.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),j(""),A("");const i=new FormData;i.append("title",h.title),i.append("description",h.description),h.link&&i.append("link",h.link),i.append("isActive",h.isActive?"true":"false"),h.image&&i.append("image",h.image);try{v?(await a.A.put(`${r.A}/api/services/${v}`,i,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}}),A("\u2705 Service updated successfully!")):(await a.A.post(`${r.A}/api/services`,i,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}}),A("\u2705 Service added successfully!")),m({title:"",description:"",link:"",image:null,isActive:!0}),g(null),document.getElementById("image-input").value="",y(),t()}catch(l){var s,n;j((null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.error)||"Failed to save service"),console.error(l)}},encType:"multipart/form-data",children:[(0,d.jsxs)("label",{children:["Title",(0,d.jsx)("input",{type:"text",name:"title",value:h.title,onChange:f,required:!0})]}),(0,d.jsxs)("label",{children:["Description",(0,d.jsx)("textarea",{name:"description",value:h.description,onChange:f,required:!0})]}),(0,d.jsxs)("label",{children:["Link",(0,d.jsx)("input",{type:"text",name:"link",value:h.link,onChange:f,placeholder:"Optional"})]}),(0,d.jsxs)("label",{children:["Image",(0,d.jsx)("input",{id:"image-input",type:"file",name:"image",accept:"image/*",onChange:f,required:!v})]}),(0,d.jsxs)("label",{children:["Active",(0,d.jsx)("input",{type:"checkbox",name:"isActive",checked:h.isActive,onChange:f})]}),(0,d.jsxs)("button",{type:"submit",children:[v?"Update":"Add"," Service"]})]}),(0,d.jsx)("h2",{children:"Services List"}),(0,d.jsx)("div",{className:"services-list",children:u.map(e=>(0,d.jsxs)("div",{className:"service-item",children:[e.image&&(0,d.jsx)("img",{src:`${r.A}${e.image}`,alt:e.title}),(0,d.jsx)("h3",{children:e.title}),(0,d.jsx)("p",{children:e.description}),e.link&&(0,d.jsxs)("p",{children:["Link: ",e.link]}),(0,d.jsxs)("p",{children:["Status: ",e.isActive?"Active":"Inactive"]}),(0,d.jsx)("button",{onClick:()=>(e=>{m({title:e.title,description:e.description,link:e.link||"",image:null,isActive:e.isActive}),g(e._id)})(e),children:"Edit"}),(0,d.jsx)("button",{onClick:()=>(async e=>{try{await a.A.delete(`${r.A}/api/services/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),A("\u2705 Service deleted successfully!"),y(),t()}catch(i){j("Failed to delete service"),console.error(i)}})(e._id),children:"Delete"})]},e._id))})]})}}}]);
//# sourceMappingURL=120.6ef7aca5.chunk.js.map