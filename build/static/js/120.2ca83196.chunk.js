"use strict";(self.webpackChunkgypsum_app=self.webpackChunkgypsum_app||[]).push([[120],{2120:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var s=i(5043),a=i(6213),n=i(8729),l=i(8268),c=i(1283),r=i(4505),o=i(579);const d=function(){const{user:e,logout:t}=(0,s.useContext)(n.c),{triggerRefresh:i}=(0,s.useContext)(l.h),d=(0,c.Zp)(),[p,u]=(0,s.useState)([]),[h,m]=(0,s.useState)({title:"",description:"",link:"",image:null,isActive:!0}),[v,g]=(0,s.useState)(null),[x,j]=(0,s.useState)(""),[k,A]=(0,s.useState)("");(0,s.useEffect)(()=>{e&&"admin"===e.role?y():d("/login")},[e,d]);const y=async()=>{try{const e=await a.A.get(`${r.A}/api/services`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});u(e.data.services)}catch(e){j("Failed to fetch services"),console.error(e)}},f=e=>{const{name:t,type:i,value:s,files:a,checked:n}=e.target;m("file"===i?{...h,image:a[0]}:"checkbox"===i?{...h,isActive:n}:{...h,[t]:s})};return(0,o.jsxs)("section",{className:"admin-dashboard",children:[(0,o.jsxs)("div",{className:"admin-header",children:[(0,o.jsx)("h1",{children:"Admin Dashboard"}),(0,o.jsx)("button",{onClick:t,children:"Logout"})]}),(0,o.jsx)("h2",{children:v?"Edit Service":"Add Service"}),x&&(0,o.jsx)("p",{className:"error",children:x}),k&&(0,o.jsx)("p",{className:"success",children:k}),(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),j(""),A("");const t=new FormData;t.append("title",h.title),t.append("description",h.description),h.link&&t.append("link",h.link),t.append("isActive",h.isActive),h.image&&t.append("image",h.image);try{v?(await a.A.put(`${r.A}/api/services/${v}`,t,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}}),A("Service updated successfully!")):(await a.A.post(`${r.A}/api/services`,t,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}}),A("Service added successfully!")),m({title:"",description:"",link:"",image:null,isActive:!0}),g(null),document.getElementById("image-input").value="",y(),i()}catch(l){var s,n;j((null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.error)||"Failed to save service"),console.error(l)}},encType:"multipart/form-data",children:[(0,o.jsxs)("label",{children:["Title",(0,o.jsx)("input",{type:"text",name:"title",value:h.title,onChange:f,required:!0})]}),(0,o.jsxs)("label",{children:["Description",(0,o.jsx)("textarea",{name:"description",value:h.description,onChange:f,required:!0})]}),(0,o.jsxs)("label",{children:["Link",(0,o.jsx)("input",{type:"text",name:"link",value:h.link,onChange:f,placeholder:"Optionnel"})]}),(0,o.jsxs)("label",{children:["Image",(0,o.jsx)("input",{id:"image-input",type:"file",name:"image",accept:"image/*",onChange:f,required:!v})]}),(0,o.jsxs)("label",{children:["Active",(0,o.jsx)("input",{type:"checkbox",name:"isActive",checked:h.isActive,onChange:f})]}),(0,o.jsxs)("button",{type:"submit",children:[v?"Update":"Add"," Service"]})]}),(0,o.jsx)("h2",{children:"Services List"}),(0,o.jsx)("div",{className:"services-list",children:p.map(e=>(0,o.jsxs)("div",{className:"service-item",children:[(0,o.jsx)("img",{src:`http://localhost:5000${e.image}`,alt:e.title}),(0,o.jsx)("h3",{children:e.title}),(0,o.jsx)("p",{children:e.description}),(0,o.jsxs)("p",{children:["Link: ",e.link]}),(0,o.jsxs)("p",{children:["Status: ",e.isActive?"Active":"Inactive"]}),(0,o.jsx)("button",{onClick:()=>(e=>{m({title:e.title,description:e.description,link:e.link,image:null,isActive:e.isActive}),g(e._id)})(e),children:"Edit"}),(0,o.jsx)("button",{onClick:()=>(async e=>{try{await a.A.delete(`${r.A}/api/services/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),A("Service deleted successfully!"),y(),i()}catch(t){j("Failed to delete service"),console.error(t)}})(e._id),children:"Delete"})]},e._id))})]})}}}]);
//# sourceMappingURL=120.2ca83196.chunk.js.map